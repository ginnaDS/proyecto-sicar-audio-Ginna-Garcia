<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui">

    <body>

        <ui:composition template="./../../WEB-INF/protegido/clienteTemplate.xhtml">

            <ui:define name="content">
                <f:view>
                <ol class="breadcrumb migaR" >
                      <li><a href="principal.xhtml" data-toggle="tab" aria-hidden="true">Inicio</a></li>
                    
                      <li class="active"><a href="pedigen.xhtml">Pedidos</a></li>
                    </ol>
                </f:view>
                
                     <center> <h:form id="form">
                    <center><h1><h:outputText value="Cambiar estado de los pedidos"/> </h1></center>
                    
                    <p:dataTable class="tbl" value="#{pedController.pedidos}" paginator="true" rendered="true" var="ped"  rows="5">
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Codigo Pedido"/>
                            </f:facet>
                            <h:outputText value="#{ped.idPedido}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Fecha de Solicitud"/>
                            </f:facet>
                            <h:outputText value="#{ped.fecha}">
                            <f:convertDateTime pattern="MM/dd/yyyy HH:mm:ss" />
                            </h:outputText>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Cliente"/>
                            </f:facet>
                            <h:outputText value="#{ped.idCliente.idUsuario.primerNombre} #{ped.idCliente.idUsuario.primerApellido}"/>                    </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Estado"/>
                            </f:facet>
                            <h:outputText value="#{ped.idEstadoPe.tipoEstadoP}"/>
                        </p:column>
                        <p:column>
                            <f:facet name="header">
                                <h:outputText value="Cambiar Estado"/>
                            </f:facet>
                            <p:commandButton onclick="PF('estado').show()" update=":cam" actionListener="#{pedController.cambiarEs(ped)}" value="Cambiar"/>
                        </p:column>
                    </p:dataTable>
                    </h:form></center>
                <p:dialog widgetVar="estado">
                    <h:form id="cam">
                        <h:panelGrid columns="2">
                        <h:outputLabel value="Fecha de solicitud:"/>
                        <p:outputLabel value="#{pedController.pedido.fecha}">
                                <f:convertDateTime pattern="MM/dd/yyyy HH:mm:ss" />
                            </p:outputLabel>
                        <h:outputLabel value="Cliente:"/>
                        <p:outputLabel value="#{pedController.pedido.idCliente.idUsuario.nombreUsuario}"/>
                        <h:outputLabel value="Estado:"/>
                        <h:selectOneMenu id="idEstadoPe" value="#{pedController.estado.idEstadoPe}" >
                                <f:selectItem itemLabel="Seleccione" itemValue="#{null}"/>
                                <f:selectItems value="#{pedController.estados}" var="est" itemLabel="#{est.tipoEstadoP}" itemValue="#{est.idEstadoPe}"/>
                            </h:selectOneMenu>
                        </h:panelGrid>
                        <p:commandButton value="Guardar Cambios" actionListener="#{pedController.actualizar()}" update=":form"/>
                    </h:form>
                </p:dialog>
               </ui:define>

        </ui:composition>

    </body>
</html>
